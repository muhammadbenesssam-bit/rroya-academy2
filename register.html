<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฃูุงุฏูููุฉ ุฑุคูุฉ - ุชุณุฌูู ุฌุฏูุฏ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'raaya-green': '#a7f3d0', 
                        'raaya-beige': '#f5f5dc',
                        'raaya-sky': '#87ceeb', 
                        'raaya-dark': '#1e293b', 
                        'raaya-light': '#ffffff',
                    },
                }
            }
        }
    </script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-raaya-beige text-gray-800 transition-colors duration-300 dark:bg-raaya-dark dark:text-raaya-light flex items-center justify-center min-h-screen">
    
    <div class="w-full max-w-lg bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 space-y-6">
        <h2 class="text-3xl font-bold text-center text-raaya-dark dark:text-raaya-light">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h2>
        
        <form id="register-form" class="space-y-4">
            
            <div>
                <label for="full_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ุงูุงุณู ุงูุฑุจุงุนู (ุจุงููุบุฉ ุงูุนุฑุจูุฉ)</label>
                <input type="text" id="full_name" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-raaya-sky focus:border-raaya-sky dark:bg-gray-700 dark:border-gray-600 dark:text-white" pattern="^[\u0621-\u064A\s]{5,}" title="ุงูุงุณู ูุฌุจ ุฃู ูููู ุจุงููุบุฉ ุงูุนุฑุจูุฉ">
            </div>

            <div>
                <label for="governorate" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ุงููุญุงูุธุฉ</label>
                <select id="governorate" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-raaya-sky focus:border-raaya-sky dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <option value="" disabled selected>ุงุฎุชุฑ ูุญุงูุธุชู</option>
                    <option value="cairo">ุงููุงูุฑุฉ</option>
                    <option value="giza">ุงูุฌูุฒุฉ</option>
                    <option value="alexandria">ุงูุฅุณููุฏุฑูุฉ</option>
                    <option value="qalyubia">ุงูููููุจูุฉ</option>
                    <option value="sharqia">ุงูุดุฑููุฉ</option>
                    <option value="monufia">ุงููููููุฉ</option>
                    <option value="beheira">ุงูุจุญูุฑุฉ</option>
                    <option value="gharbia">ุงูุบุฑุจูุฉ</option>
                    <option value="kafr_el_sheikh">ููุฑ ุงูุดูุฎ</option>
                    <option value="damietta">ุฏููุงุท</option>
                    <option value="port_said">ุจูุฑุณุนูุฏ</option>
                    <option value="suez">ุงูุณููุณ</option>
                    <option value="ismailia">ุงูุฅุณูุงุนูููุฉ</option>
                    <option value="fayoum">ุงููููู</option>
                    <option value="beni_suef">ุจูู ุณููู</option>
                    <option value="minya">ุงููููุง</option>
                    <option value="asyut">ุฃุณููุท</option>
                    <option value="sohag">ุณููุงุฌ</option>
                    <option value="qena">ููุง</option>
                    <option value="luxor">ุงูุฃูุตุฑ</option>
                    <option value="aswan">ุฃุณูุงู</option>
                    <option value="red_sea">ุงูุจุญุฑ ุงูุฃุญูุฑ</option>
                    <option value="new_valley">ุงููุงุฏู ุงูุฌุฏูุฏ</option>
                    <option value="matrouh">ูุทุฑูุญ</option>
                    <option value="north_sinai">ุดูุงู ุณููุงุก</option>
                    <option value="south_sinai">ุฌููุจ ุณููุงุก</option>
                </select>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ุงูููุน</label>
                <div class="flex space-x-4 space-x-reverse">
                    <label class="inline-flex items-center">
                        <input type="radio" name="gender" value="male" required class="form-radio text-raaya-sky h-4 w-4">
                        <span class="mr-2 text-gray-700 dark:text-gray-300">ุฐูุฑ</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" name="gender" value="female" required class="form-radio text-raaya-sky h-4 w-4">
                        <span class="mr-2 text-gray-700 dark:text-gray-300">ุฃูุซู</span>
                    </label>
                </div>
            </div>

            <div>
                <label for="username" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ุงุณู ุงููุณุชุฎุฏู ููุฏุฎูู (ุจุงูุฃุญุฑู ุงูุนุฑุจูุฉุ ุงููุงุชูููุฉุ ุฃู ุงูุฃุฑูุงู)</label>
                <input type="text" id="username" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-raaya-sky focus:border-raaya-sky dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            </div>

            <div>
                <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ูููุฉ ุงููุฑูุฑ</label>
                <div class="relative mt-1">
                    <input type="password" id="password" required class="block w-full pr-10 px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-raaya-sky focus:border-raaya-sky dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    <button type="button" id="togglePassword" class="absolute inset-y-0 left-0 flex items-center pr-3 text-gray-500 hover:text-raaya-dark dark:text-gray-400 dark:hover:text-raaya-light">
                        ๐๏ธ
                    </button>
                </div>
            </div>

            <div>
                <label for="contact" class="block text-sm font-medium text-gray-700 dark:text-gray-300">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ุฑูู ุงููุงุชู</label>
                <input type="text" id="contact" required class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-raaya-sky focus:border-raaya-sky dark:bg-gray-700 dark:border-gray-600 dark:text-white" title="ุฃุฏุฎู ุจุฑูุฏ ุฅููุชุฑููู ุตุงูุญ ุฃู ุฑูู ูุงุชู">
            </div>
            
            <button type="submit" class="w-full px-4 py-2 bg-raaya-sky text-white font-bold rounded-lg shadow-md hover:bg-raaya-dark transition duration-300">
                ุชุณุฌูู ุฌุฏูุฏ
            </button>
        </form>
        
        <p id="message" class="text-center font-medium"></p>

        <div class="text-center text-sm">
            <a href="login.html" class="text-raaya-sky hover:underline">ูู ูุฏูู ุญุณุงุจุ ุชุณุฌูู ุงูุฏุฎูู</a>
            <span class="mx-2">|</span>
            <a href="index.html" class="text-gray-500 hover:underline">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</a>
        </div>
    </div>
    
    <script type="module">
        // ุงุณุชูุฑุงุฏ ุฏุงูุฉ ุงูุชุณุฌูู ูู progress_logic.js
        import { registerUser } from './js/progress_logic.js';

        // ุฏุงูุฉ ุฅุธูุงุฑ/ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ
        document.getElementById('togglePassword').addEventListener('click', function () {
            const passwordInput = document.getElementById('password');
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            // ุชุบููุฑ ุฑูุฒ ุงูุนูู ุญุณุจ ุงูุญุงูุฉ (ุงุฎุชูุงุฑู)
            this.textContent = type === 'password' ? '๐๏ธ' : '๐';
        });

        // ููุทู ุงูุชุณุฌูู
        document.getElementById('register-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const fullName = document.getElementById('full_name').value.trim();
            const governorate = document.getElementById('governorate').value;
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const contact = document.getElementById('contact').value.trim();
            const message = document.getElementById('message');

            if (!username || !password) {
                message.textContent = 'ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ.';
                message.className = 'text-red-500 text-center font-medium';
                return;
            }
            
            // ุชุญูู ูู ุฃู ุงูุงุณู ุงูุฑุจุงุนู ุนุฑุจู
            const arabicNameRegex = /^[\u0621-\u064A\s]{5,}$/;
            if (!arabicNameRegex.test(fullName)) {
                 message.textContent = 'ุงูุงุณู ุงูุฑุจุงุนู ูุฌุจ ุฃู ูููู ุจุงููุบุฉ ุงูุนุฑุจูุฉ.';
                 message.className = 'text-red-500 text-center font-medium';
                 return;
            }

            // ุงูุชุญูู ูู ุงุณู ุงููุณุชุฎุฏู (ูุณูุญ ุจุงูุฅูุฌููุฒูุฉุ ุงูุฃุฑูุงูุ ูุงูุนุฑุจูุฉ)
            const usernameRegex = /^[A-Za-z0-9\u0600-\u06FF\s]+$/;
            if (!usernameRegex.test(username)) {
                 message.textContent = 'ุงุณู ุงููุณุชุฎุฏู ูุฌุจ ุฃู ูููู ุจุฃุญุฑู ูุฃุฑูุงู ุนุฑุจูุฉ ุฃู ูุงุชูููุฉ ููุท.';
                 message.className = 'text-red-500 text-center font-medium';
                 return;
            }

            // ูุชู ุญูุธ ูุงูุฉ ุงูุจูุงูุงุช ูู Local Storage
            const userData = {
                password: password,
                fullName: fullName,
                governorate: governorate,
                gender: gender,
                contact: contact
            };

            // ุฏุงูุฉ registerUser (ุงูููุฌูุฏุฉ ูู progress_logic.js) ุชุญุชุงุฌ ุฅูู ุชุนุฏูู ุจุณูุท ูุชูุจู ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ
            // ุณููุชุฑุถ ุฃููุง ุณููุฑุฑ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ุฏุงุฎู ุงูููุฏ ูุชุฎุฒูููุง
            
            if (registerUser(username, password, userData)) {
                message.textContent = '๐ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ. ุณูุชู ุชูุฌููู ูุตูุญุฉ ุงูุฏุฎูู.';
                message.className = 'text-raaya-green text-center font-bold';
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1500);
            } else {
                message.textContent = 'โ๏ธ ุงุณู ุงููุณุชุฎุฏู ููุฌูุฏ ุจุงููุนู. ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุงุณู ุขุฎุฑ.';
                message.className = 'text-red-500 text-center font-medium';
            }
        });
    </script>
</body>
</html>